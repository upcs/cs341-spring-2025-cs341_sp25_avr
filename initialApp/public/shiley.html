<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP Tour Camera page</title>
    <link rel="stylesheet" href="stylesheets/building_c.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"> 
import buildingContent from './content.js';
import buildingDescriptions from './description.js'; 
</script>

</head>

<body onload="updateYear('shiley', null)">
    <div id="phone-container">
<div class = "dropdown">
        <button id = "menu-button" class="dropbtn"><i class="fa fa-bars"></i> Menu </button>

    <div id="myDropdown" class="dropdown-content">
    <button class="link" id= "home-toggle">Home</button>
    <button class="link" id= "map-toggle">Map</button>
</div>
</div>


        <div class="building-photo">
           
            <embed id="buildingImage" src="archiveContent\shiley\1948.jpg" alt="Picture of Shiley" style="width: 100%; height: 100%;">
        </div>

        <h1 id="buildingText">Engineering Hall</h1>
        <h3 id="yearText">1948</h3>

        <p id="descriptionText">The Engineering building was opened in 1948. It was designed and the construction was supervised by<span id="dots">...</span><span id="toggle-text"> the architectural firm of Jacobberger, Stanton & Zeller. The building was built by the Ross B. Hammond Co. of Portland, Oregon.</span></P>

       <button class="link" id="read-button">Read more</button>
           
       <button id = "past-button" ><i class="fa fa-step-backward"></i> Past </button>
       <button id = "future-button" style= color:gray;> Future <i class="fa fa-step-forward"></i></button>
        
   <script>
   
   //setting variables for timeline
    const descriptionPaths = {
    'shiley': {
        '1948': 'photoDescriptions\\shiley\\1948.txt',
        '1969': 'photoDescriptions\\shiley\\1969.txt',
        '2009': 'photoDescriptions\\shiley\\2009.txt',
    },
    'waldschmidt': {
      // add paths here after i import the content
    }
    // add more buildings here...
};


//functions for timeline 

//determines year of next event/timeline if possible, 
//building for hashmap and forward boolean for future(true) or past(false) in timeline
function updateYear(building, forward) {
    const years = Object.keys(descriptionPaths[building]);
    years.sort()

    //if not going forwards or backwards, default is most recent year
    if(forward == null) {
        updateInfo(building, years[years.length - 1])
        return
    }

    let currentYear = document.getElementById('yearText').innerText
    let currentIndex = years.indexOf(currentYear)
    //goes to future year if possible and going forward
    if (currentIndex + 1 < years.length && forward == true){
        currentIndex = currentIndex + 1
        currentYear = years[currentIndex]
        updateInfo(building, currentYear)
    }
       
    //goes to past year if possible and going backwards
    if (currentIndex > 0 && forward == false){
        currentIndex = currentIndex - 1
        currentYear = years[currentIndex]
        updateInfo(building, currentYear)
    } 

    //grays or whites out future and past buttons if event is possible
    document.getElementById("future-button").style = "color:floralwhite;"
    document.getElementById("past-button").style = "color:floralwhite;"
    if (currentIndex == 0) {
        document.getElementById("past-button").style = "color:gray;"
    } 
     if(currentIndex == years.length - 1) {
        document.getElementById("future-button").style = "color:gray;"
    }

}

//updates all of the relevant texts and images to new event 
function updateInfo(building, year) {
    //updates image to new current year, only if year changes to avoid flashing/needless update
    if(year != document.getElementById('yearText').innerText) {
    const imagePath = "archiveContent\\" + building + "\\" + year + ".jpg"
    document.getElementById("buildingImage").setAttribute("src" , imagePath)
    }

    //updates year to the new current year
    document.getElementById('yearText').innerText = year

    //updates description text to current year
    fetch(descriptionPaths[building][year])
    .then((response) => response.text())
    .then((text) => {
        //depending on if user selected to read more updates length of description text accordingly
        if( $('#read-button').text() == "Read more" ){
            document.getElementById('descriptionText').innerText = text.slice(0,95) + "...";
        } else {
             document.getElementById('descriptionText').innerText = text;
        }
    });
}




    //buttons on clicks
    $(document).ready(function(){ 


     $("#menu-button").click(function(){
    $("#myDropdown").toggle();
}); 

   document.getElementById("home-toggle").onclick = function () {
   window.location.href = "index.html";
   }; 
  
   document.getElementById("map-toggle").onclick = function () {
   window.location.href = "geo.html";
   }; 

   document.getElementById("past-button").onclick = function () {
    updateYear("shiley", false)
    }; 

    document.getElementById("future-button").onclick = function () {
        updateYear("shiley", true)
};        
  
     $("#read-button").click(function(){
     var text = $(this).text();

     if (text === 'Read more') {
            $(this).text('Read less');
        } else {
            $(this).text('Read more');
        }
      
     //$("#dots").toggle();
     //$("#toggle-text").toggle();
     updateInfo("shiley", document.getElementById('yearText').innerText)
 });

}); 

    </script> 


  </body>          
    
</html>

